// Contains various mappings/hardcoded values used by the cpu

// for memory accesses
function CONSTS() {
  this.READ = 0
  this.WRITE = 1
  this.EXEC = 2
}

// instantiate a copy
CONSTS = new CONSTS()

// register mappings from disasm.cc
var reg_maps = [
  'zero',
  'ra',
  's0',
  's1',
  's2',
  's3',
  's4',
  's5',
  's6',
  's7',
  's8',
  's9',
  'sA',
  'sB',
  'sp',
  'tp',
  'v0',
  'v1',
  'a0',
  'a1',
  'a2',
  'a3',
  'a4',
  'a5',
  'a6',
  'a7',
  't0',
  't1',
  't2',
  't3',
  't4',
  'gp'
]

// var PCR = {
//     "CSR_FFLAGS":    {"num": 0x001, "width": 64,}, // width not confirmed
//     "CSR_FRM":       {"num": 0x002, "width": 64,}, // width not confirmed
//     "CSR_FCSR":      {"num": 0x003, "width": 64,}, // width not confirmed

//     "CSR_SUP0":      {"num": 0x500, "width": 64,},
//     "CSR_SUP1":      {"num": 0x501, "width": 64,},
//     "CSR_EPC":       {"num": 0x502, "width": 64,},
//     "CSR_BADVADDR":  {"num": 0x503, "width": 64,},
//     "CSR_PTBR":      {"num": 0x504, "width": 64,},
//     "CSR_ASID":      {"num": 0x505, "width": 64,}, // implementation defined
//     "CSR_COUNT":     {"num": 0x506, "width": 32,},
//     "CSR_COMPARE":   {"num": 0x507, "width": 32,},
//     "CSR_EVEC":      {"num": 0x508, "width": 64,},
//     "CSR_CAUSE":     {"num": 0x509, "width": 64,},
//     "CSR_STATUS":    {"num": 0x50A, "width": 32,},
//     "CSR_HARTID":    {"num": 0x50B, "width": 64,},
//     "CSR_IMPL":      {"num": 0x50C, "width": 64,},
//     "CSR_FATC":      {"num": 0x50D, "width": 64,}, // implementation defined (by ASIDLEN)
//     "CSR_SEND_IPI":  {"num": 0x50E, "width": 64,},
//     "CSR_CLEAR_IPI": {"num": 0x50F, "width": 64,},

//     "CSR_STATS":     {"num": 0x51C, "width": 64,}, // width not confirmed
//     "CSR_RESET":     {"num": 0x51D, "width": 64,}, // width not confirmed

//     "CSR_TOHOST":    {"num": 0x51E, "width": 64,},
//     "CSR_FROMHOST":  {"num": 0x51F, "width": 64,},

//     "CSR_CYCLE":     {"num": 0xC00, "width": 32,}, // width not confirmed
//     "CSR_TIME":      {"num": 0xC01, "width": 64,}, // width not confirmed
//     "CSR_INSTRET":   {"num": 0xC02, "width": 64,}, // width not confirmed
// };

var PCR = {
  CSR_USTATUS: { num: 0, width: 64 },
  CSR_UIE: { num: 4, width: 64 },
  CSR_UTVEC: { num: 5, width: 64 },
  CSR_USCRATCH: { num: 64, width: 64 },
  CSR_UEPC: { num: 65, width: 64 },
  CSR_UCAUSE: { num: 66, width: 64 },
  CSR_UTVAL: { num: 67, width: 64 },
  CSR_UIP: { num: 68, width: 64 },
  CSR_FFLAGS: { num: 1, width: 64 },
  CSR_FRM: { num: 2, width: 64 },
  CSR_FCSR: { num: 3, width: 64 },
  CSR_CYCLE: { num: 3072, width: 64 },
  CSR_TIME: { num: 3073, width: 64 },
  CSR_INSTRET: { num: 3074, width: 64 },
  CSR_HPMCOUNTER3: { num: 3075, width: 64 },
  CSR_HPMCOUNTER4: { num: 3076, width: 64 },
  CSR_HPMCOUNTER5: { num: 3077, width: 64 },
  CSR_HPMCOUNTER6: { num: 3078, width: 64 },
  CSR_HPMCOUNTER7: { num: 3079, width: 64 },
  CSR_HPMCOUNTER8: { num: 3080, width: 64 },
  CSR_HPMCOUNTER9: { num: 3081, width: 64 },
  CSR_HPMCOUNTER10: { num: 3082, width: 64 },
  CSR_HPMCOUNTER11: { num: 3083, width: 64 },
  CSR_HPMCOUNTER12: { num: 3084, width: 64 },
  CSR_HPMCOUNTER13: { num: 3085, width: 64 },
  CSR_HPMCOUNTER14: { num: 3086, width: 64 },
  CSR_HPMCOUNTER15: { num: 3087, width: 64 },
  CSR_HPMCOUNTER16: { num: 3088, width: 64 },
  CSR_HPMCOUNTER17: { num: 3089, width: 64 },
  CSR_HPMCOUNTER18: { num: 3090, width: 64 },
  CSR_HPMCOUNTER19: { num: 3091, width: 64 },
  CSR_HPMCOUNTER20: { num: 3092, width: 64 },
  CSR_HPMCOUNTER21: { num: 3093, width: 64 },
  CSR_HPMCOUNTER22: { num: 3094, width: 64 },
  CSR_HPMCOUNTER23: { num: 3095, width: 64 },
  CSR_HPMCOUNTER24: { num: 3096, width: 64 },
  CSR_HPMCOUNTER25: { num: 3097, width: 64 },
  CSR_HPMCOUNTER26: { num: 3098, width: 64 },
  CSR_HPMCOUNTER27: { num: 3099, width: 64 },
  CSR_HPMCOUNTER28: { num: 3100, width: 64 },
  CSR_HPMCOUNTER29: { num: 3101, width: 64 },
  CSR_HPMCOUNTER30: { num: 3102, width: 64 },
  CSR_HPMCOUNTER31: { num: 3103, width: 64 },
  CSR_CYCLEH: { num: 3200, width: 64 },
  CSR_TIMEH: { num: 3201, width: 64 },
  CSR_INSTRETH: { num: 3202, width: 64 },
  CSR_HPMCOUNTER3H: { num: 3203, width: 64 },
  CSR_HPMCOUNTER4H: { num: 3204, width: 64 },
  CSR_HPMCOUNTER5H: { num: 3205, width: 64 },
  CSR_HPMCOUNTER6H: { num: 3206, width: 64 },
  CSR_HPMCOUNTER7H: { num: 3207, width: 64 },
  CSR_HPMCOUNTER8H: { num: 3208, width: 64 },
  CSR_HPMCOUNTER9H: { num: 3209, width: 64 },
  CSR_HPMCOUNTER10H: { num: 3210, width: 64 },
  CSR_HPMCOUNTER11H: { num: 3211, width: 64 },
  CSR_HPMCOUNTER12H: { num: 3212, width: 64 },
  CSR_HPMCOUNTER13H: { num: 3213, width: 64 },
  CSR_HPMCOUNTER14H: { num: 3214, width: 64 },
  CSR_HPMCOUNTER15H: { num: 3215, width: 64 },
  CSR_HPMCOUNTER16H: { num: 3216, width: 64 },
  CSR_HPMCOUNTER17H: { num: 3217, width: 64 },
  CSR_HPMCOUNTER18H: { num: 3218, width: 64 },
  CSR_HPMCOUNTER19H: { num: 3219, width: 64 },
  CSR_HPMCOUNTER20H: { num: 3220, width: 64 },
  CSR_HPMCOUNTER21H: { num: 3221, width: 64 },
  CSR_HPMCOUNTER22H: { num: 3222, width: 64 },
  CSR_HPMCOUNTER23H: { num: 3223, width: 64 },
  CSR_HPMCOUNTER24H: { num: 3224, width: 64 },
  CSR_HPMCOUNTER25H: { num: 3225, width: 64 },
  CSR_HPMCOUNTER26H: { num: 3226, width: 64 },
  CSR_HPMCOUNTER27H: { num: 3227, width: 64 },
  CSR_HPMCOUNTER28H: { num: 3228, width: 64 },
  CSR_HPMCOUNTER29H: { num: 3229, width: 64 },
  CSR_HPMCOUNTER30H: { num: 3230, width: 64 },
  CSR_HPMCOUNTER31H: { num: 3231, width: 64 },
  CSR_SSTATUS: { num: 256, width: 64 },
  CSR_SEDELEG: { num: 258, width: 64 },
  CSR_SIDELEG: { num: 259, width: 64 },
  CSR_SIE: { num: 260, width: 64 },
  CSR_STVEC: { num: 261, width: 64 },
  CSR_SCOUNTEREN: { num: 262, width: 64 },
  CSR_SSCRATCH: { num: 320, width: 64 },
  CSR_SEPC: { num: 321, width: 64 },
  CSR_SCAUSE: { num: 322, width: 64 },
  CSR_STVAL: { num: 323, width: 64 },
  CSR_SIP: { num: 324, width: 64 },
  CSR_SATP: { num: 384, width: 64 },
  CSR_MVENDORID: { num: 3857, width: 64 },
  CSR_MARCHID: { num: 3858, width: 64 },
  CSR_MIMPID: { num: 3859, width: 64 },
  CSR_MHARTID: { num: 3860, width: 64 },
  CSR_MSTATUS: { num: 768, width: 64 },
  CSR_MISA: { num: 769, width: 64 },
  CSR_MEDELEG: { num: 770, width: 64 },
  CSR_MIDELEG: { num: 771, width: 64 },
  CSR_MIE: { num: 772, width: 64 },
  CSR_MTVEC: { num: 773, width: 64 },
  CSR_MCOUNTEREN: { num: 774, width: 64 },
  CSR_MSCRATCH: { num: 832, width: 64 },
  CSR_MEPC: { num: 833, width: 64 },
  CSR_MCAUSE: { num: 834, width: 64 },
  CSR_MTVAL: { num: 835, width: 64 },
  CSR_MIP: { num: 836, width: 64 },
  CSR_PMPCFG0: { num: 928, width: 64 },
  CSR_PMPCFG1: { num: 929, width: 64 },
  CSR_PMPCFG2: { num: 930, width: 64 },
  CSR_PMPCFG3: { num: 931, width: 64 },
  CSR_PMPADDR0: { num: 944, width: 64 },
  CSR_PMPADDR1: { num: 945, width: 64 },
  CSR_PMPADDR2: { num: 946, width: 64 },
  CSR_PMPADDR3: { num: 947, width: 64 },
  CSR_PMPADDR4: { num: 948, width: 64 },
  CSR_PMPADDR5: { num: 949, width: 64 },
  CSR_PMPADDR6: { num: 950, width: 64 },
  CSR_PMPADDR7: { num: 951, width: 64 },
  CSR_PMPADDR8: { num: 952, width: 64 },
  CSR_PMPADDR9: { num: 953, width: 64 },
  CSR_PMPADDR10: { num: 954, width: 64 },
  CSR_PMPADDR11: { num: 955, width: 64 },
  CSR_PMPADDR12: { num: 956, width: 64 },
  CSR_PMPADDR13: { num: 957, width: 64 },
  CSR_PMPADDR14: { num: 958, width: 64 },
  CSR_PMPADDR15: { num: 959, width: 64 },
  CSR_MCYCLE: { num: 2816, width: 64 },
  CSR_MINSTRET: { num: 2818, width: 64 },
  CSR_MHPMCOUNTER3: { num: 2819, width: 64 },
  CSR_MHPMCOUNTER4: { num: 2820, width: 64 },
  CSR_MHPMCOUNTER5: { num: 2821, width: 64 },
  CSR_MHPMCOUNTER6: { num: 2822, width: 64 },
  CSR_MHPMCOUNTER7: { num: 2823, width: 64 },
  CSR_MHPMCOUNTER8: { num: 2824, width: 64 },
  CSR_MHPMCOUNTER9: { num: 2825, width: 64 },
  CSR_MHPMCOUNTER10: { num: 2826, width: 64 },
  CSR_MHPMCOUNTER11: { num: 2827, width: 64 },
  CSR_MHPMCOUNTER12: { num: 2828, width: 64 },
  CSR_MHPMCOUNTER13: { num: 2829, width: 64 },
  CSR_MHPMCOUNTER14: { num: 2830, width: 64 },
  CSR_MHPMCOUNTER15: { num: 2831, width: 64 },
  CSR_MHPMCOUNTER16: { num: 2832, width: 64 },
  CSR_MHPMCOUNTER17: { num: 2833, width: 64 },
  CSR_MHPMCOUNTER18: { num: 2834, width: 64 },
  CSR_MHPMCOUNTER19: { num: 2835, width: 64 },
  CSR_MHPMCOUNTER20: { num: 2836, width: 64 },
  CSR_MHPMCOUNTER21: { num: 2837, width: 64 },
  CSR_MHPMCOUNTER22: { num: 2838, width: 64 },
  CSR_MHPMCOUNTER23: { num: 2839, width: 64 },
  CSR_MHPMCOUNTER24: { num: 2840, width: 64 },
  CSR_MHPMCOUNTER25: { num: 2841, width: 64 },
  CSR_MHPMCOUNTER26: { num: 2842, width: 64 },
  CSR_MHPMCOUNTER27: { num: 2843, width: 64 },
  CSR_MHPMCOUNTER28: { num: 2844, width: 64 },
  CSR_MHPMCOUNTER29: { num: 2845, width: 64 },
  CSR_MHPMCOUNTER30: { num: 2846, width: 64 },
  CSR_MHPMCOUNTER31: { num: 2847, width: 64 },
  CSR_MCYCLEH: { num: 2944, width: 64 },
  CSR_MINSTRETH: { num: 2946, width: 64 },
  CSR_MHPMCOUNTER3H: { num: 2947, width: 64 },
  CSR_MHPMCOUNTER4H: { num: 2948, width: 64 },
  CSR_MHPMCOUNTER5H: { num: 2949, width: 64 },
  CSR_MHPMCOUNTER6H: { num: 2950, width: 64 },
  CSR_MHPMCOUNTER7H: { num: 2951, width: 64 },
  CSR_MHPMCOUNTER8H: { num: 2952, width: 64 },
  CSR_MHPMCOUNTER9H: { num: 2953, width: 64 },
  CSR_MHPMCOUNTER10H: { num: 2954, width: 64 },
  CSR_MHPMCOUNTER11H: { num: 2955, width: 64 },
  CSR_MHPMCOUNTER12H: { num: 2956, width: 64 },
  CSR_MHPMCOUNTER13H: { num: 2957, width: 64 },
  CSR_MHPMCOUNTER14H: { num: 2958, width: 64 },
  CSR_MHPMCOUNTER15H: { num: 2959, width: 64 },
  CSR_MHPMCOUNTER16H: { num: 2960, width: 64 },
  CSR_MHPMCOUNTER17H: { num: 2961, width: 64 },
  CSR_MHPMCOUNTER18H: { num: 2962, width: 64 },
  CSR_MHPMCOUNTER19H: { num: 2963, width: 64 },
  CSR_MHPMCOUNTER20H: { num: 2964, width: 64 },
  CSR_MHPMCOUNTER21H: { num: 2965, width: 64 },
  CSR_MHPMCOUNTER22H: { num: 2966, width: 64 },
  CSR_MHPMCOUNTER23H: { num: 2967, width: 64 },
  CSR_MHPMCOUNTER24H: { num: 2968, width: 64 },
  CSR_MHPMCOUNTER25H: { num: 2969, width: 64 },
  CSR_MHPMCOUNTER26H: { num: 2970, width: 64 },
  CSR_MHPMCOUNTER27H: { num: 2971, width: 64 },
  CSR_MHPMCOUNTER28H: { num: 2972, width: 64 },
  CSR_MHPMCOUNTER29H: { num: 2973, width: 64 },
  CSR_MHPMCOUNTER30H: { num: 2974, width: 64 },
  CSR_MHPMCOUNTER31H: { num: 2975, width: 64 },
  CSR_MHPEVENTM3: { num: 803, width: 64 },
  CSR_MHPEVENTM4: { num: 804, width: 64 },
  CSR_MHPEVENTM5: { num: 805, width: 64 },
  CSR_MHPEVENTM6: { num: 806, width: 64 },
  CSR_MHPEVENTM7: { num: 807, width: 64 },
  CSR_MHPEVENTM8: { num: 808, width: 64 },
  CSR_MHPEVENTM9: { num: 809, width: 64 },
  CSR_MHPEVENTM10: { num: 810, width: 64 },
  CSR_MHPEVENTM11: { num: 811, width: 64 },
  CSR_MHPEVENTM12: { num: 812, width: 64 },
  CSR_MHPEVENTM13: { num: 813, width: 64 },
  CSR_MHPEVENTM14: { num: 814, width: 64 },
  CSR_MHPEVENTM15: { num: 815, width: 64 },
  CSR_MHPEVENTM16: { num: 816, width: 64 },
  CSR_MHPEVENTM17: { num: 817, width: 64 },
  CSR_MHPEVENTM18: { num: 818, width: 64 },
  CSR_MHPEVENTM19: { num: 819, width: 64 },
  CSR_MHPEVENTM20: { num: 820, width: 64 },
  CSR_MHPEVENTM21: { num: 821, width: 64 },
  CSR_MHPEVENTM22: { num: 822, width: 64 },
  CSR_MHPEVENTM23: { num: 823, width: 64 },
  CSR_MHPEVENTM24: { num: 824, width: 64 },
  CSR_MHPEVENTM25: { num: 825, width: 64 },
  CSR_MHPEVENTM26: { num: 826, width: 64 },
  CSR_MHPEVENTM27: { num: 827, width: 64 },
  CSR_MHPEVENTM28: { num: 828, width: 64 },
  CSR_MHPEVENTM29: { num: 829, width: 64 },
  CSR_MHPEVENTM30: { num: 830, width: 64 },
  CSR_MHPEVENTM31: { num: 831, width: 64 },
  CSR_TSELECT: { num: 1952, width: 64 },
  CSR_TDATA1: { num: 1953, width: 64 },
  CSR_TDATA2: { num: 1954, width: 64 },
  CSR_TDATA3: { num: 1955, width: 64 },
  CSR_DCSR: { num: 1968, width: 64 },
  CSR_DPC: { num: 1969, width: 64 },
  CSR_DSCRATCH: { num: 1970, width: 64 }
}

// var PCR = {
//   CSR_FFLAGS: { num: 0x001, width: 64 },
//   CSR_FRM: { num: 0x002, width: 64 },
//   CSR_FCSR: { num: 0x003, width: 64 },
//   CSR_SUP0: { num: 0x500, width: 64 },
//   CSR_SUP1: { num: 0x501, width: 64 },
//   CSR_EPC: { num: 0x502, width: 64 },
//   CSR_BADVADDR: { num: 0x503, width: 64 },
//   CSR_PTBR: { num: 0x504, width: 64 },
//   CSR_ASID: { num: 0x505, width: 64 },
//   CSR_COUNT: { num: 0x506, width: 32 },
//   CSR_COMPARE: { num: 0x507, width: 32 },
//   CSR_EVEC: { num: 0x508, width: 64 },
//   CSR_CAUSE: { num: 0x509, width: 64 },
//   CSR_STATUS: { num: 0x50a, width: 32 },
//   CSR_HARTID: { num: 0x50b, width: 64 },
//   CSR_IMPL: { num: 0x50c, width: 64 },
//   CSR_FATC: { num: 0x50d, width: 64 },
//   CSR_SEND_IPI: { num: 0x50e, width: 64 },
//   CSR_CLEAR_IPI: { num: 0x50f, width: 64 },
//   CSR_STATS: { num: 0x51c, width: 64 },
//   CSR_RESET: { num: 0x51d, width: 64 },
//   CSR_TOHOST: { num: 0x51e, width: 64 },
//   CSR_FROMHOST: { num: 0x51f, width: 64 },
//   CSR_CYCLE: { num: 0xc00, width: 32 },
//   CSR_TIME: { num: 0xc01, width: 64 },
//   CSR_INSTRET: { num: 0xc02, width: 64 }
// };

// status register bit mappings
var SR = {
  SR_S: 0x00000001,
  SR_PS: 0x00000002,
  SR_EI: 0x00000004,
  SR_PEI: 0x00000008,
  SR_EF: 0x00000010,
  SR_U64: 0x00000020,
  SR_S64: 0x00000040,
  SR_VM: 0x00000080,
  SR_EA: 0x00000100,
  SR_IM: 0x00ff0000,
  SR_IP: 0xff000000
}

// TRAPS: [exception code, interruptBit]
var TRAPS = {
  'Instruction Address Misaligned': [0x0, 0x0],
  'Instruction Access Fault': [0x1, 0x0],
  'Illegal Instruction': [0x2, 0x0],
  'Privileged Instruction': [0x3, 0x0],
  'Floating-Point Disabled': [0x4, 0x0],
  'System Call': [0x6, 0x0],
  Breakpoint: [0x7, 0x0],
  'Load Address Misaligned': [0x8, 0x0],
  'Store Address Misaligned': [0x9, 0x0],
  'Load Access Fault': [0xa, 0x0],
  'Store Access Fault': [0xb, 0x0],
  'Accelerator Disabled': [0xc, 0x0],
  'Timer interrupt': [0x7, 0x1],
  'Host interrupt': [0x6, 0x1]
}

/*
var SYSCALLS = {
    93: "sys_exit",
    63: "sys_read",
    64: "sys_write",
    1024: "sys_open",
    57: "sys_close",
    80: "sys_fstat",
    62: "sys_lseek",
    1038: "sys_stat",
    1039: "sys_lstat",
    1025: "sys_link",
    1026: "sys_unlink",
    67: "sys_pread",
    68: "sys_pwrite",
    2011: "sys_getmainvars",
};

var SYSCALL_HANDLERS = {
    "sys_exit": sys_exit,
    "sys_read": sys_read,
    "sys_write": sys_write,
    "sys_open": sys_open,
    "sys_close": sys_close,
    "sys_fstat": sys_fstat,
    "sys_lseek": sys_lseek,
    "sys_stat": sys_stat,
    "sys_lstat": sys_lstat,
    "sys_link": sys_link,
    "sys_unlink": sys_unlink,
    "sys_pread": sys_pread,
    "sys_pwrite": sys_pwrite,
    "sys_getmainvars": sys_getmainvars,
};
*/
